const a0_0x5c5a08=a0_0xd31d;(function(_0x296c98,_0x2a2faa){const _0x4c8ab1=a0_0xd31d,_0x14a010=_0x296c98();while(!![]){try{const _0x57b7fa=-parseInt(_0x4c8ab1(0xa0))/0x1+parseInt(_0x4c8ab1(0x98))/0x2*(-parseInt(_0x4c8ab1(0x91))/0x3)+-parseInt(_0x4c8ab1(0xa8))/0x4*(-parseInt(_0x4c8ab1(0xa6))/0x5)+-parseInt(_0x4c8ab1(0xb9))/0x6*(-parseInt(_0x4c8ab1(0xaa))/0x7)+parseInt(_0x4c8ab1(0x97))/0x8+-parseInt(_0x4c8ab1(0xb8))/0x9*(parseInt(_0x4c8ab1(0xb4))/0xa)+-parseInt(_0x4c8ab1(0x99))/0xb*(-parseInt(_0x4c8ab1(0xa1))/0xc);if(_0x57b7fa===_0x2a2faa)break;else _0x14a010['push'](_0x14a010['shift']());}catch(_0x4888a1){_0x14a010['push'](_0x14a010['shift']());}}}(a0_0x424d,0x1a8d4));function a0_0xd31d(_0x1046db,_0x1c09f9){const _0x424d81=a0_0x424d();return a0_0xd31d=function(_0xd31da1,_0x243425){_0xd31da1=_0xd31da1-0x91;let _0x5c7efd=_0x424d81[_0xd31da1];return _0x5c7efd;},a0_0xd31d(_0x1046db,_0x1c09f9);}const express=require('express'),multer=require(a0_0x5c5a08(0x9e)),fs=require('fs'),path=require(a0_0x5c5a08(0x93)),xlsx=require(a0_0x5c5a08(0xb2)),cors=require(a0_0x5c5a08(0xa5)),app=express(),os=require('os'),{extractTestID}=require(a0_0x5c5a08(0xba)),port=0xbb8,upload=multer({'dest':a0_0x5c5a08(0xbc)});function a0_0x424d(){const _0x4dc357=['970067FfLGoX','Failed\x20to\x20fetch\x20test\x20IDs\x20from\x20the\x20API.','readFile','/close','utils','Error\x20making\x20POST\x20request\x20to\x20/visit\x20API:','/visit','SheetNames','xlsx','No\x20browser\x20session\x20is\x20active.','1843570GQOxkF','log','/screenshot_course_search.png','map','9tJxaNP','6khRpLy','./extractTestID','send','uploads/','User\x20Email','sheet_to_json','48wHyeqW','Sheets','path','json','status','/screenshot','450080jPjiwy','14534FzXBUP','30701PxnAoH','listen','http://localhost:4200','Browser\x20closed.','post','multer','get','59012umccec','300eeNQdv','use','message','file','cors','339635bYjCvS','No\x20file\x20uploaded.','12DbBztz','LOGIN_URL,\x20USEREMAIL,\x20and\x20PASSWORD\x20are\x20required.'];a0_0x424d=function(){return _0x4dc357;};return a0_0x424d();}app[a0_0x5c5a08(0xa2)](cors({'origin':['https://forntend-weightagesplit-1.onrender.com',a0_0x5c5a08(0x9b)]})),app[a0_0x5c5a08(0xa2)](express[a0_0x5c5a08(0x94)]());let driver;app[a0_0x5c5a08(0x9d)](a0_0x5c5a08(0xb0),upload['single'](a0_0x5c5a08(0xa4)),async(_0x370434,_0x4e2f0f)=>{const _0x3e270e=a0_0x5c5a08;if(!_0x370434[_0x3e270e(0xa4)])return _0x4e2f0f[_0x3e270e(0x95)](0x190)[_0x3e270e(0xbb)]({'error':_0x3e270e(0xa7)});let {LOGIN_URL:_0x1a79f5,USEREMAIL:_0x2b465d,PASSWORD:_0x56c37a,COURSE:_0x22a2bc,MODULE:_0x1d74a4,TESTNAME:_0x3e591f}=_0x370434['body'];if(!_0x1a79f5||!_0x2b465d||!_0x56c37a)return _0x4e2f0f[_0x3e270e(0x95)](0x190)[_0x3e270e(0xbb)]({'error':_0x3e270e(0xa9)});const _0x5b0073=_0x370434[_0x3e270e(0xa4)]['path'],_0x3601f5=xlsx[_0x3e270e(0xac)](_0x5b0073),_0xdd480=_0x3601f5[_0x3e270e(0xb1)][0x0],_0x267efc=xlsx[_0x3e270e(0xae)][_0x3e270e(0xbe)](_0x3601f5[_0x3e270e(0x92)][_0xdd480]),_0x38f316=_0x267efc[_0x3e270e(0xb7)](_0x3f91d9=>{const _0x1a88c3=_0x3e270e;return{'UEmail':_0x3f91d9[_0x1a88c3(0xbd)]};});let _0x5b75a6=[],_0x4086a7=null;try{const {testIds:_0x3e5c23,token:_0x40c04e}=await extractTestID(_0x5b0073,_0x1a79f5,_0x2b465d,_0x56c37a,_0x22a2bc,_0x1d74a4,_0x3e591f);_0x5b75a6=_0x3e5c23,_0x4086a7=_0x4086a7||_0x40c04e,_0x4e2f0f[_0x3e270e(0xbb)]({'testIds':_0x5b75a6,'token':_0x4086a7});}catch(_0x448eac){console['error'](_0x3e270e(0xaf),_0x448eac[_0x3e270e(0xa3)]),_0x4e2f0f[_0x3e270e(0x95)](0x1f4)[_0x3e270e(0xbb)]({'error':_0x3e270e(0xab)});return;}}),app[a0_0x5c5a08(0x9f)](a0_0x5c5a08(0x96),(_0x11c4a3,_0x538719)=>{const _0x5e595f=a0_0x5c5a08;_0x538719['sendFile'](__dirname+_0x5e595f(0xb6));}),app['get'](a0_0x5c5a08(0xad),async(_0x359eb5,_0x296711)=>{const _0x39987d=a0_0x5c5a08;driver?(await driver['quit'](),driver=null,_0x296711[_0x39987d(0xbb)]({'message':_0x39987d(0x9c)})):_0x296711[_0x39987d(0xbb)]({'message':_0x39987d(0xb3)});}),app[a0_0x5c5a08(0x9a)](port,()=>{const _0x136152=a0_0x5c5a08;console[_0x136152(0xb5)]('ðŸš€\x20Server\x20is\x20running\x20at\x20http://localhost:'+port);});