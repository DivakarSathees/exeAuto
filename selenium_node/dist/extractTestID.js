const a0_0x2bb016=a0_0x3be1;function a0_0x3be1(_0x37bf26,_0x4cdaa5){const _0x32a1ab=a0_0x32a1();return a0_0x3be1=function(_0x3be1e8,_0x3ed0f8){_0x3be1e8=_0x3be1e8-0x1cf;let _0x1b7856=_0x32a1ab[_0x3be1e8];return _0x1b7856;},a0_0x3be1(_0x37bf26,_0x4cdaa5);}(function(_0x198e27,_0xdea346){const _0x26e042=a0_0x3be1,_0x451408=_0x198e27();while(!![]){try{const _0x3ead8c=parseInt(_0x26e042(0x1f9))/0x1*(parseInt(_0x26e042(0x210))/0x2)+-parseInt(_0x26e042(0x1e9))/0x3*(parseInt(_0x26e042(0x1d5))/0x4)+parseInt(_0x26e042(0x1e1))/0x5*(parseInt(_0x26e042(0x213))/0x6)+-parseInt(_0x26e042(0x1ee))/0x7+parseInt(_0x26e042(0x1cf))/0x8*(parseInt(_0x26e042(0x1e7))/0x9)+parseInt(_0x26e042(0x20d))/0xa+-parseInt(_0x26e042(0x1f0))/0xb*(parseInt(_0x26e042(0x20f))/0xc);if(_0x3ead8c===_0xdea346)break;else _0x451408['push'](_0x451408['shift']());}catch(_0x3e53e2){_0x451408['push'](_0x451408['shift']());}}}(a0_0x32a1,0x44a20));const puppeteer=require(a0_0x2bb016(0x1d4)),xlsx=require(a0_0x2bb016(0x206)),fs=require('fs');require(a0_0x2bb016(0x212))[a0_0x2bb016(0x1e3)]();const delay=_0x15c3a9=>new Promise(_0x20a83e=>setTimeout(_0x20a83e,_0x15c3a9));function a0_0x32a1(){const _0xdc48fb=['User\x20Email','config','utils','setViewport','pages','807507ebyfHm','goto','238899WevtMk','map','launch','#password','extractTestID','3374630yRshFa','SheetNames','55hAoJLq','click','match','.form__button.ladda-button','--no-sandbox','Logging\x20in...1','#emailAddress','unlinkSync','Error\x20in\x20puplocalstorage:','1Odnuqa','--start-maximized','Launching\x20automation...','input[placeholder=\x22Enter\x20your\x20search\x20term\x22]','type','--disable-dev-shm-usage','error','newPage','readFile','Logging\x20in...8','env','Logging\x20in...6','token','xlsx','PUPPETEER_EXECUTABLE_PATH','input[placeholder=\x27Enter\x20course\x20name\x20to\x20search\x27]','Processing\x20email:','--disable-setuid-sandbox','keyboard','Logging\x20in...2','1449910HbihFS','log','206376kMhsQC','890094KlhwOJ','Logging\x20in...4','dotenv','18akOuAl','8xdmmJP','bringToFront','Chromium\x20not\x20found\x20at\x20/usr/bin/chromium','length','close','puppeteer','16OGYcjY','--ignore-certificate-errors','networkidle2','push','Backspace','li[ptooltip=\x27Courses\x27]','Backspace\x20pressed','button.search-icon','waitForSelector','executablePath','Searching\x20for\x20course...','Logging\x20in...7','813285AWkCGQ'];a0_0x32a1=function(){return _0xdc48fb;};return a0_0x32a1();}exports[a0_0x2bb016(0x1ed)]=async(_0x2d6bf6,_0x39787d,_0x2c4983,_0x18b8be,_0x3cbae3,_0x286d32,_0x85299f)=>{const _0x4443b8=a0_0x2bb016;try{console[_0x4443b8(0x20e)](_0x4443b8(0x1fb));const _0x28847a=_0x2d6bf6,_0x26fa9d=xlsx[_0x4443b8(0x201)](_0x28847a),_0x2700a6=_0x26fa9d[_0x4443b8(0x1ef)][0x0],_0x48a90d=xlsx[_0x4443b8(0x1e4)]['sheet_to_json'](_0x26fa9d['Sheets'][_0x2700a6]),_0x3fb80e=_0x48a90d[_0x4443b8(0x1ea)](_0x3707e7=>({'UEmail':_0x3707e7[_0x4443b8(0x1e2)]}));fs[_0x4443b8(0x1f7)](_0x28847a),console[_0x4443b8(0x20e)]('Extracted\x20User\x20Emails:',_0x3fb80e);!fs['existsSync']('/usr/bin/chromium')?console[_0x4443b8(0x1ff)](_0x4443b8(0x1d1)):console[_0x4443b8(0x20e)]('Chromium\x20found\x20at\x20/usr/bin/chromium');const {testIds:_0x10049d,token:_0xd4aeb0}=await loginAndGetLocalStorage(_0x39787d,_0x2c4983,_0x18b8be,_0x3cbae3,_0x286d32,_0x85299f,_0x3fb80e);return{'testIds':_0x10049d,'token':_0xd4aeb0};}catch(_0x1f109f){console[_0x4443b8(0x1ff)](_0x4443b8(0x1f8),_0x1f109f);throw _0x1f109f;}};async function loginAndGetLocalStorage(_0x2f2803,_0x2196b8,_0x3abf50,_0x2a915b,_0x5b08e0,_0x3de42d,_0x312f8b){const _0x238352=a0_0x2bb016,_0x324e91=await puppeteer[_0x238352(0x1eb)]({'headless':![],'args':[_0x238352(0x1f4),_0x238352(0x20a),_0x238352(0x1fe),'--remote-debugging-port=9222',_0x238352(0x1fa),_0x238352(0x1d6)],'executablePath':process[_0x238352(0x203)]['NODE_ENV']==='production'?process['env'][_0x238352(0x207)]:puppeteer[_0x238352(0x1de)](),'protocolTimeout':0x1d4c0}),_0x2ee35c=await _0x324e91[_0x238352(0x200)]();await _0x2ee35c[_0x238352(0x1e5)]({'width':0x780,'height':0x438});try{await _0x2ee35c[_0x238352(0x1e8)](_0x2f2803,{'waitUntil':_0x238352(0x1d7)}),await _0x2ee35c[_0x238352(0x1fd)](_0x238352(0x1f6),_0x2196b8),await _0x2ee35c['type'](_0x238352(0x1ec),_0x3abf50),console[_0x238352(0x20e)](_0x238352(0x1f5)),await _0x2ee35c[_0x238352(0x1f1)](_0x238352(0x1f3)),console[_0x238352(0x20e)](_0x238352(0x20c)),console[_0x238352(0x20e)]('Logging\x20in...3'),await delay(0x3a98),console['log'](_0x238352(0x211)),await _0x2ee35c['waitForSelector']('li[ptooltip=\x27Courses\x27]',{'timeout':0x7530}),await _0x2ee35c['click'](_0x238352(0x1da)),console[_0x238352(0x20e)]('Logging\x20in...5'),await delay(0x3a98),console['log'](_0x238352(0x204)),await _0x2ee35c['waitForSelector'](_0x238352(0x208),{'timeout':0x7530}),console[_0x238352(0x20e)](_0x238352(0x1e0)),await _0x2ee35c[_0x238352(0x1fd)](_0x238352(0x208),_0x2a915b),await delay(0x2710),console[_0x238352(0x20e)](_0x238352(0x202)),await _0x2ee35c[_0x238352(0x1f1)](_0x238352(0x1dc)),await delay(0xfa0),console[_0x238352(0x20e)](_0x238352(0x1df));const courseClicked=await _0x2ee35c.evaluate(text=>{const xpath=`//*[contains(text(), "${text}")]`;const result=document.evaluate(xpath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);const node=result.singleNodeValue;if(node){node.click();return true;}return false;},_0x2a915b);if(!courseClicked)console.log('\u274C Course not found or click failed.');else console.log('\u2705 Course clicked.');await delay(0x3a98);const moduleClicked=await _0x2ee35c.evaluate(moduleIndex=>{const xpath=`//*[@id="ui-tabpanel-3"]/div/div/div[1]/div[3]/div[${moduleIndex}]`;const result=document.evaluate(xpath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);const node=result.singleNodeValue;if(node){node.click();return true;}return false;},_0x5b08e0);if(!moduleClicked)console.log('\u274C Module not found or click failed.');else console.log('\u2705 Module clicked.');await delay(0xfa0);try{const testClicked=await _0x2ee35c.evaluate(testName=>{const xpath=`//div[contains(@class, 'moduletest')][.//div[contains(@class, 'ui-g-5') and contains(normalize-space(.), "${testName}")]]//button[normalize-space(text())='View Results']`;const result=document.evaluate(xpath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);const node=result.singleNodeValue;if(node){node.click();return true;}return false;},_0x3de42d);if(!testClicked)console.log('\u274C Test Result button not found.');else console.log('\u2705 Test Result clicked.');}catch(_0x12cae6){const testClicked=await _0x2ee35c.evaluate(testName=>{const xpath1=`//div[contains(@class, 'moduletest')][.//span[contains(@class, 'testname') and normalize-space(text()) = '${testName}']]//button[normalize-space(text())='View Results']`;const result1=document.evaluate(xpath1,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);const node1=result1.singleNodeValue;if(node1){node1.click();return true;}return false;},_0x3de42d);if(!testClicked)console.log('\u274C Test Result button not found.');else console.log('\u2705 Test Result clicked.');}await delay(0xfa0);const _0xcc6146=[];for(const {UEmail:_0x146bfe}of _0x312f8b){console['log'](_0x238352(0x209),_0x146bfe),await _0x2ee35c[_0x238352(0x1dd)]('input[placeholder=\x22Enter\x20your\x20search\x20term\x22]'),await _0x2ee35c[_0x238352(0x1f1)](_0x238352(0x1fc),{'clickCount':0x3}),await _0x2ee35c[_0x238352(0x20b)]['press'](_0x238352(0x1d9)),console['log'](_0x238352(0x1db)),await delay(0x3e8),await _0x2ee35c[_0x238352(0x1fd)]('input[placeholder=\x22Enter\x20your\x20search\x20term\x22]',_0x146bfe,{'delay':0x64}),console['log']('Email\x20entered:',_0x146bfe),await delay(0x3e8),await _0x2ee35c[_0x238352(0x1f1)]('button.ui-inputgroup-addon-ec'),await delay(0xbb8),await _0x2ee35c[_0x238352(0x1dd)]('#testresulttable\x20tr:nth-child(2)\x20td:nth-child(4)\x20span:nth-child(2)\x20i'),await _0x2ee35c[_0x238352(0x1f1)]('#testresulttable\x20tr:nth-child(2)\x20td:nth-child(4)\x20span:nth-child(2)\x20i'),await delay(0xbb8);const _0x560234=await _0x324e91[_0x238352(0x1e6)](),_0x6adbe7=_0x560234[_0x560234[_0x238352(0x1d2)]-0x1];if(_0x6adbe7!==_0x2ee35c){await _0x6adbe7[_0x238352(0x1d0)]();const _0x4f8fda=_0x6adbe7['url']();_0xcc6146[_0x238352(0x1d8)]({'testId':_0x4f8fda,'email':_0x146bfe}),await _0x6adbe7[_0x238352(0x1d3)](),await _0x2ee35c['bringToFront']();}}const localStorageData=await _0x2ee35c.evaluate(()=>{const data={};for(let i=0;i<localStorage.length;i++){const key=localStorage.key(i);data[key]=localStorage.getItem(key);}return data;}),_0x16417f=localStorageData[_0x238352(0x205)]?.[_0x238352(0x1f2)](/"token":"(.*?)"/),_0x36713d=_0x16417f?_0x16417f[0x1]:null;if(_0x36713d){}else console['log']('❌\x20Token\x20not\x20found.');return{'testIds':_0xcc6146,'token':_0x36713d};}catch(_0x51e549){console['error']('Error\x20during\x20Puppeteer\x20workflow:',_0x51e549);throw _0x51e549;}finally{await _0x324e91['close']();}}